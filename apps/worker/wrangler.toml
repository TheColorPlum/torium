# Torium Worker Configuration
name = "torium-worker"
main = "src/index.ts"
compatibility_date = "2024-02-22"

# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "torium-db"
database_id = "a0983129-1b80-4161-9257-9dd454bfb844"

# Queue producer binding
[[queues.producers]]
binding = "CLICKS_QUEUE"
queue = "torium-clicks"

# Queue consumer configuration
[[queues.consumers]]
queue = "torium-clicks"
max_batch_size = 100
max_batch_timeout = 30

# Environment variables (secrets - set via `wrangler secret put`)
# Required:
#   RESEND_API_KEY - API key for Resend email service
#   SESSION_SECRET - Secret for session token hashing
#
# Set using:
#   wrangler secret put RESEND_API_KEY
#   wrangler secret put SESSION_SECRET

[vars]
# Non-secret configuration
APP_URL = "https://torium.app"
MAGIC_LINK_EXPIRY_MINUTES = "15"
SESSION_EXPIRY_DAYS = "30"

# Development overrides
[env.development]
vars = { APP_URL = "http://localhost:8787" }

# Preview environment
[env.preview]
vars = { APP_URL = "https://preview.torium.app" }
